var tagBox,commentsBox,pm_sanitize,editPermalink,makeSlugeditClickable,WPSetThumbnailHTML,WPSetThumbnailID,WPRemoveThumbnail,wptitlehint;function array_unique_noempty(t){var e=[];return jQuery.each(t,function(t,s){(s=jQuery.trim(s))&&-1==jQuery.inArray(s,e)&&e.push(s)}),e}!function(t){tagBox={clean:function(t){var e=postL10n.comma;return","!==e&&(t=t.replace(new RegExp(e,"g"),",")),t=t.replace(/\s*,\s*/g,",").replace(/,+/g,",").replace(/[,\s]+$/,"").replace(/^[,\s]+/,""),","!==e&&(t=t.replace(/,/g,e)),t},parseTags:function(e){var s=e.id.split("-check-num-")[1],i=t(e).closest(".tagsdiv"),n=i.find(".the-tags"),a=postL10n.comma,o=n.val().split(a),l=[];return delete o[s],t.each(o,function(e,s){(s=t.trim(s))&&l.push(s)}),n.val(this.clean(l.join(a))),this.quickClicks(i),!1},quickClicks:function(e){var s,i,n=t(".the-tags",e),a=t(".tagchecklist",e),o=t(e).attr("id");n.length&&(i=n.prop("disabled"),s=n.val().split(postL10n.comma),a.empty(),t.each(s,function(e,s){var n,l;(s=t.trim(s))&&(n=t("<span />").text(s),i||((l=t('<a id="'+o+"-check-num-"+e+'" class="ntdelbutton">X</a>')).click(function(){tagBox.parseTags(this)}),n.prepend("&nbsp;").prepend(l)),a.append(n))}))},flushTags:function(e,s,i){var n,a,o,l=t(".the-tags",e),c=t("input.newtag",e),r=postL10n.comma;return o=(s=s||!1)?t(s).text():c.val(),a=(n=l.val())?n+r+o:o,a=array_unique_noempty((a=this.clean(a)).split(r)).join(r),l.val(a),this.quickClicks(e),s||c.val(""),void 0===i&&c.focus(),!1},get:function(e){var s=e.substr(e.indexOf("-")+1);t.post(ajaxurl,{action:"get-tagcloud",tax:s},function(i,n){0!==i&&"success"==n||(i=wpAjax.broken),i=t('<p id="tagcloud-'+s+'" class="the-tagcloud">'+i+"</p>"),t("a",i).click(function(){return tagBox.flushTags(t(this).closest(".inside").children(".tagsdiv"),this),!1}),t("#"+e).after(i)})},init:function(){var e=this,s=t("div.ajaxtag");t(".tagsdiv").each(function(){tagBox.quickClicks(this)}),t("input.tagadd",s).click(function(){e.flushTags(t(this).closest(".tagsdiv"))}),t("div.taghint",s).click(function(){t(this).css("visibility","hidden").parent().siblings(".newtag").focus()}),t("input.newtag",s).blur(function(){""===this.value&&t(this).parent().siblings(".taghint").css("visibility","")}).focus(function(){t(this).parent().siblings(".taghint").css("visibility","hidden")}).keyup(function(e){if(13==e.which)return tagBox.flushTags(t(this).closest(".tagsdiv")),!1}).keypress(function(t){if(13==t.which)return t.preventDefault(),!1}).each(function(){var e=t(this).closest("div.tagsdiv").attr("id");t(this).suggest(ajaxurl+"?action=ajax-tag-search&tax="+e,{delay:500,minchars:2,multiple:!0,multipleSep:postL10n.comma+" "})}),t("#post").submit(function(){t("div.tagsdiv").each(function(){tagBox.flushTags(this,!1,1)})}),t("a.tagcloud-link").click(function(){return tagBox.get(t(this).attr("id")),t(this).unbind().click(function(){return t(this).siblings(".the-tagcloud").toggle(),!1}),!1})}},commentsBox={st:0,get:function(e,s){var i,n=this.st;return s||(s=20),this.st+=s,this.total=e,t("#commentsdiv .spinner").show(),i={action:"get-comments",mode:"single",_ajax_nonce:t("#add_comment_nonce").val(),p:t("#post_ID").val(),start:n,number:s},t.post(ajaxurl,i,function(e){if(e=wpAjax.parseAjaxResponse(e),t("#commentsdiv .widefat").show(),t("#commentsdiv .spinner").hide(),"object"==typeof e&&e.responses[0])return t("#the-comment-list").append(e.responses[0].data),theList=theExtraList=null,t("a[className*=':']").unbind(),void(commentsBox.st>commentsBox.total?t("#show-comments").hide():t("#show-comments").show().children("a").html(postL10n.showcomm));1!=e?t("#the-comment-list").append('<tr><td colspan="2">'+wpAjax.broken+"</td></tr>"):t("#show-comments").html(postL10n.endcomm)}),!1}},pm_sanitize={stripTags:function(t){return(t=t||"").replace(/<!--[\s\S]*?(-->|$)/g,"").replace(/<(script|style)[^>]*>[\s\S]*?(<\/\1>|$)/gi,"").replace(/<\/?[a-z][\s\S]*?(>|$)/gi,"")},stripTagsAndEncodeText:function(t){var e=pm_sanitize.stripTags(t),s=document.createElement("textarea");try{s.innerHTML=e,e=pm_sanitize.stripTags(s.value)}catch(t){}return e}},WPSetThumbnailHTML=function(e){t(".inside","#postimagediv").html(e)},WPSetThumbnailID=function(e){var s=t('input[value="_thumbnail_id"]',"#list-table");s.size()>0&&t("#meta\\["+s.attr("id").match(/[0-9]+/)+"\\]\\[value\\]").text(e)},WPRemoveThumbnail=function(e){t.post(ajaxurl,{action:"set-post-thumbnail",post_id:t("#post_ID").val(),thumbnail_id:-1,_ajax_nonce:e,cookie:encodeURIComponent(document.cookie)},function(t){"0"==t?alert(setPostThumbnailL10n.error):WPSetThumbnailHTML(t)})},t(document).on("heartbeat-send.refresh-lock",function(e,s){var i=t("#active_post_lock").val(),n=t("#post_ID").val(),a={};n&&t("#post-lock-dialog").length&&(a.post_id=n,i&&(a.lock=i),s["wp-refresh-post-lock"]=a)}),t(document).on("heartbeat-tick.refresh-lock",function(e,s){var i,n,a;s["wp-refresh-post-lock"]&&((i=s["wp-refresh-post-lock"]).lock_error?(n=t("#post-lock-dialog")).length&&!n.is(":visible")&&("function"==typeof autosave&&(t(document).on("autosave-disable-buttons.post-lock",function(){n.addClass("saving")}).on("autosave-enable-buttons.post-lock",function(){n.removeClass("saving").addClass("saved"),window.onbeforeunload=null}),autosave()||(window.onbeforeunload=null),autosave=function(){}),i.lock_error.avatar_src&&(a=t('<img class="avatar avatar-64 photo" width="64" height="64" />').attr("src",i.lock_error.avatar_src.replace(/&amp;/g,"&")),n.find("div.post-locked-avatar").empty().append(a)),n.show().find(".currently-editing").text(i.lock_error.text),n.find(".wp-tab-first").focus()):i.new_lock&&t("#active_post_lock").val(i.new_lock))})}(jQuery),function(t){var e,s;function i(){e=!1,window.clearTimeout(s),s=window.setTimeout(function(){e=!0},3e5)}t(document).on("heartbeat-send.wp-refresh-nonces",function(s,i){var n,a;e&&(a=t("#post_ID").val())&&(n=t("#_wpnonce").val())&&(i["wp-refresh-post-nonces"]={post_id:a,post_nonce:n})}).on("heartbeat-tick.wp-refresh-nonces",function(e,s){var n=s["wp-refresh-post-nonces"];n&&(i(),n.replace&&t.each(n.replace,function(e,s){t("#"+e).val(s)}),n.heartbeatNonce&&(window.heartbeatSettings.nonce=n.heartbeatNonce))}).ready(function(){i()})}(jQuery),jQuery(document).ready(function(t){var e,s,i,n,a="",o=0,l=t("#content");postboxes.add_postbox_toggles(pagenow),t("#post-lock-dialog .notification-dialog").on("keydown",function(e){if(9==e.which){var s=t(e.target);s.hasClass("wp-tab-first")&&e.shiftKey?(t(this).find(".wp-tab-last").focus(),e.preventDefault()):s.hasClass("wp-tab-last")&&!e.shiftKey&&(t(this).find(".wp-tab-first").focus(),e.preventDefault())}}).filter(":visible").find(".wp-tab-first").focus(),"undefined"!=typeof wp&&wp.heartbeat&&t("#post-lock-dialog").length&&wp.heartbeat.interval(15),t("#tagsdiv-post_tag").length?tagBox.init():t("#side-sortables, #normal-sortables, #advanced-sortables").children("div.postbox").each(function(){if(0===this.id.indexOf("tagsdiv-"))return tagBox.init(),!1}),t(".categorydiv").each(function(){var e,s,i,n,a;(i=t(this).attr("id").split("-")).shift(),n=i.join("-"),a=n+"_tab","category"==n&&(a="cats"),t("a","#"+n+"-tabs").click(function(){var e=t(this).attr("href");return t(this).parent().addClass("tabs").siblings("li").removeClass("tabs"),t("#"+n+"-tabs").siblings(".tabs-panel").hide(),t(e).show(),"#"+n+"-all"==e?deleteUserSetting(a):setUserSetting(a,"pop"),!1}),getUserSetting(a)&&t('a[href="#'+n+'-pop"]',"#"+n+"-tabs").click(),t("#new"+n).one("focus",function(){t(this).val("").removeClass("form-input-tip")}),t("#new"+n).keypress(function(e){13===e.keyCode&&(e.preventDefault(),t("#"+n+"-add-submit").click())}),t("#"+n+"-add-submit").click(function(){t("#new"+n).focus()}),e=function(e){return!!t("#new"+n).val()&&(e.data+="&"+t(":checked","#"+n+"checklist").serialize(),t("#"+n+"-add-submit").prop("disabled",!0),e)},s=function(e,s){var i,a=t("#new"+n+"_parent");t("#"+n+"-add-submit").prop("disabled",!1),"undefined"!=s.parsed.responses[0]&&(i=s.parsed.responses[0].supplemental.newcat_parent)&&(a.before(i),a.remove())},t("#"+n+"checklist").wpList({alt:"",response:n+"-ajax-response",addBefore:e,addAfter:s}),t("#"+n+"-add-toggle").click(function(){return t("#"+n+"-adder").toggleClass("wp-hidden-children"),t('a[href="#'+n+'-all"]',"#"+n+"-tabs").click(),t("#new"+n).focus(),!1}),t("#"+n+"checklist, #"+n+"checklist-pop").on("click",'li.popular-category > label input[type="checkbox"]',function(){var e=t(this),s=e.is(":checked"),i=e.val();i&&e.parents("#taxonomy-"+n).length&&t("#in-"+n+"-"+i+", #in-popular-"+n+"-"+i).prop("checked",s)})}),t("#postcustom").length&&t("#the-list").wpList({addAfter:function(){t("table#list-table").show()},addBefore:function(e){return e.data+="&post_id="+t("#post_ID").val(),e}}),t("#submitdiv").length&&(e=t("#timestamp").html(),s=t("#post-visibility-display").html(),i=function(){var e=t("#post-visibility-select");"public"!=t("input:radio:checked",e).val()?(t("#sticky").prop("checked",!1),t("#sticky-span").hide()):t("#sticky-span").show(),"password"!=t("input:radio:checked",e).val()?t("#password-span").hide():t("#password-span").show()},n=function(){if(!t("#timestampdiv").length)return!0;var s,i,n,a,o=t("#post_status"),l=t('option[value="publish"]',o),c=t("#aa").val(),r=t("#mm").val(),p=t("#jj").val(),d=t("#hh").val(),u=t("#mn").val();return s=new Date(c,r-1,p,d,u),i=new Date(t("#hidden_aa").val(),t("#hidden_mm").val()-1,t("#hidden_jj").val(),t("#hidden_hh").val(),t("#hidden_mn").val()),n=new Date(t("#cur_aa").val(),t("#cur_mm").val()-1,t("#cur_jj").val(),t("#cur_hh").val(),t("#cur_mn").val()),s.getFullYear()!=c||1+s.getMonth()!=r||s.getDate()!=p||s.getMinutes()!=u?(t(".timestamp-wrap","#timestampdiv").addClass("form-invalid"),!1):(t(".timestamp-wrap","#timestampdiv").removeClass("form-invalid"),s>n&&"future"!=t("#original_post_status").val()?(a=postL10n.publishOnFuture,t("#publish").val(postL10n.schedule)):s<=n&&"publish"!=t("#original_post_status").val()?(a=postL10n.publishOn,t("#publish").val(postL10n.publish)):(a=postL10n.publishOnPast,t("#publish").val(postL10n.update)),i.toUTCString()==s.toUTCString()?t("#timestamp").html(e):t("#timestamp").html(a+" <b>"+postL10n.dateFormat.replace("%1$s",t('option[value="'+t("#mm").val()+'"]',"#mm").text()).replace("%2$s",p).replace("%3$s",c).replace("%4$s",d).replace("%5$s",u)+"</b> "),"private"==t("input:radio:checked","#post-visibility-select").val()?(t("#publish").val(postL10n.update),0===l.length?o.append('<option value="publish">'+postL10n.privatelyPublished+"</option>"):l.html(postL10n.privatelyPublished),t('option[value="publish"]',o).prop("selected",!0),t(".edit-post-status","#misc-publishing-actions").hide()):("future"==t("#original_post_status").val()||"draft"==t("#original_post_status").val()?l.length&&(l.remove(),o.val(t("#hidden_post_status").val())):l.html(postL10n.published),o.is(":hidden")&&t(".edit-post-status","#misc-publishing-actions").show()),t("#post-status-display").text(pm_sanitize.stripTagsAndEncodeText(t("option:selected",o).text())),"private"==t("option:selected",o).val()||"publish"==t("option:selected",o).val()?t("#save-post").hide():(t("#save-post").show(),"pending"==t("option:selected",o).val()?t("#save-post").show().val(postL10n.savePending):t("#save-post").show().val(postL10n.saveDraft)),!0)},t(".edit-visibility","#visibility").click(function(){return t("#post-visibility-select").is(":hidden")&&(i(),t("#post-visibility-select").slideDown("fast"),t(this).hide()),!1}),t(".cancel-post-visibility","#post-visibility-select").click(function(){return t("#post-visibility-select").slideUp("fast"),t("#visibility-radio-"+t("#hidden-post-visibility").val()).prop("checked",!0),t("#post_password").val(t("#hidden-post-password").val()),t("#sticky").prop("checked",t("#hidden-post-sticky").prop("checked")),t("#post-visibility-display").html(s),t(".edit-visibility","#visibility").show(),n(),!1}),t(".save-post-visibility","#post-visibility-select").click(function(){var e=t("#post-visibility-select");return e.slideUp("fast"),t(".edit-visibility","#visibility").show(),n(),"public"!=t("input:radio:checked",e).val()&&t("#sticky").prop("checked",!1),a=t("#sticky").prop("checked")?"Sticky":"",t("#post-visibility-display").html(postL10n[t("input:radio:checked",e).val()+a]),!1}),t("input:radio","#post-visibility-select").change(function(){i()}),t("#timestampdiv").siblings("a.edit-timestamp").click(function(){return t("#timestampdiv").is(":hidden")&&(t("#timestampdiv").slideDown("fast"),t("#mm").focus(),t(this).hide()),!1}),t(".cancel-timestamp","#timestampdiv").click(function(){return t("#timestampdiv").slideUp("fast"),t("#mm").val(t("#hidden_mm").val()),t("#jj").val(t("#hidden_jj").val()),t("#aa").val(t("#hidden_aa").val()),t("#hh").val(t("#hidden_hh").val()),t("#mn").val(t("#hidden_mn").val()),t("#timestampdiv").siblings("a.edit-timestamp").show(),n(),!1}),t(".save-timestamp","#timestampdiv").click(function(){return n()&&(t("#timestampdiv").slideUp("fast"),t("#timestampdiv").siblings("a.edit-timestamp").show()),!1}),t("#post").on("submit",function(e){if(!n())return e.preventDefault(),t("#timestampdiv").show(),t("#publishing-action .spinner").hide(),t("#publish").prop("disabled",!1).removeClass("button-primary-disabled"),!1}),t("#post-status-select").siblings("a.edit-post-status").click(function(){return t("#post-status-select").is(":hidden")&&(t("#post-status-select").slideDown("fast"),t(this).hide()),!1}),t(".save-post-status","#post-status-select").click(function(){return t("#post-status-select").slideUp("fast"),t("#post-status-select").siblings("a.edit-post-status").show(),n(),!1}),t(".cancel-post-status","#post-status-select").click(function(){return t("#post-status-select").slideUp("fast"),t("#post_status").val(t("#hidden_post_status").val()),t("#post-status-select").siblings("a.edit-post-status").show(),n(),!1})),t("#edit-slug-box").length&&(editPermalink=function(e){var s,i,n=0,a=t("#editable-post-name"),o=a.html(),l=t("#post_name"),c=l.val(),r=t("#edit-slug-buttons"),p=r.html(),d=t("#editable-post-name-full").html();for(t("#view-post-btn").hide(),r.html('<a href="#" class="save button button-small">'+postL10n.ok+'</a> <a class="cancel" href="#">'+postL10n.cancel+"</a>"),r.children(".save").click(function(){var s=a.children("input").val();return s==t("#editable-post-name-full").text()?t(".cancel","#edit-slug-buttons").click():(t.post(ajaxurl,{action:"sample-permalink",post_id:e,new_slug:s,new_title:t("#title").val(),samplepermalinknonce:t("#samplepermalinknonce").val()},function(e){var i=t("#edit-slug-box");i.html(e),i.hasClass("hidden")&&i.fadeIn("fast",function(){i.removeClass("hidden")}),r.html(p),l.val(s),makeSlugeditClickable(),t("#view-post-btn").show()}),!1)}),t(".cancel","#edit-slug-buttons").click(function(){return t("#view-post-btn").show(),a.html(o),r.html(p),l.val(c),!1}),i=0;i<d.length;++i)"%"==d.charAt(i)&&n++;s=n>d.length/4?"":d,a.html('<input type="text" id="new-post-slug" value="'+s+'" />').children("input").keypress(function(t){var e=t.keyCode||0;return 13==e?(r.children(".save").click(),!1):27==e?(r.children(".cancel").click(),!1):void 0}).keyup(function(){l.val(this.value)}).focus()},(makeSlugeditClickable=function(){t("#editable-post-name").click(function(){t("#edit-slug-buttons").children(".edit-slug").click()})})()),"undefined"!=typeof wpWordCount&&(t(document).triggerHandler("wpcountwords",[l.val()]),l.keyup(function(e){var s=e.keyCode||e.charCode;return s==o||(13!=s&&8!=o&&46!=o||t(document).triggerHandler("wpcountwords",[l.val()]),o=s,!0)})),(wptitlehint=function(e){var s=t("#"+(e=e||"title")),i=t("#"+e+"-prompt-text");""===s.val()&&i.removeClass("screen-reader-text"),i.click(function(){t(this).addClass("screen-reader-text"),s.focus()}),s.blur(function(){""===this.value&&i.removeClass("screen-reader-text")}).focus(function(){i.addClass("screen-reader-text")}).keydown(function(e){i.addClass("screen-reader-text"),t(this).unbind(e)})})(),function(){var e,s=t("textarea#content"),i=null;function n(t){return s.height(Math.max(50,i+t.pageY)+"px"),!1}function a(){var e;s.focus(),t(document).unbind("mousemove",n).unbind("mouseup",a),(e=parseInt(s.css("height"),10))&&e>50&&e<5e3&&setUserSetting("ed_size",e)}!s.length||"ontouchstart"in window||(s.css("resize","none"),e=t('<div id="content-resize-handle"><br></div>'),t("#wp-content-wrap").append(e),e.on("mousedown",function(e){return i=s.height()-e.pageY,s.blur(),t(document).mousemove(n).mouseup(a),!1}))}(),"undefined"!=typeof tinymce&&(tinymce.onAddEditor.add(function(e,s){function i(){var e,s=document.getElementById("content_ifr"),i=s?parseInt(s.style.height,10):0,n=t("#content_tbl tr.mceFirst").height();return!(!i||!n)&&(e=i+n+21,e-=33)}"content"!=s.id||tinymce.isIOS5||(s.onLoadContent.add(function(){var e,s=document.getElementById("content"),i=s?parseInt(s.style.height,10):0,n=t("#content_tbl tr.mceFirst").height()||33;(!i||i<50||i>5e3)&&(i=360),getUserSetting("ed_size")>5e3&&setUserSetting("ed_size",360),(e=i-n+12)>50&&e<5e3&&(t("#content_tbl").css("height",""),t("#content_ifr").css("height",e+"px"))}),s.onSaveContent.add(function(){var e=i();!e||e<50||e>5e3||t("textarea#content").css("height",e+"px")}),s.onPostRender.add(function(){t("#content_resize").on("mousedown.wp-mce-resize",function(){t(document).on("mouseup.wp-mce-resize",function(){var e;t(document).off("mouseup.wp-mce-resize"),(e=i())&&e>50&&e<5e3&&setUserSetting("ed_size",e)})})}))}),t("#post-formats-select input.post-format").on("change.set-editor-class",function(){var e,s,i=this.id;i&&t(this).prop("checked")&&(e=tinymce.get("content"))&&((s=e.getBody()).className=s.className.replace(/\bpost-format-[^ ]+/,""),e.dom.addClass(s,"post-format-0"==i?"post-format-standard":i))}))});